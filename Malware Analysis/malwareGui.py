import os
import hashlib
from tkinter import *
from tkinter import messagebox
from tkinter import filedialog

def main():
    def selectFile():
        filepath = filedialog.askopenfilename(initialdir="C:\\Users\\Prathamesh Vanjape\\Desktop\\Malware Analysis", title="Select A File", filetype = [("All Files", "*.*"),("pdf file","*.pdf"),("docx file","*.docx"),("python Files","*.py"),("Text Files","*.txt")])
        filename = os.path.basename(filepath)
        print(filename)

        n=0
        o=0
        py=0

        hasher = hashlib.md5()
        with open(filename, 'rb' ) as open_file:
            content = open_file.read()
            hasher.update(content)



        with open("malwaremd5.txt" , "r+") as f:
            if hasher.hexdigest() not in f.read().split("\n"):
               #f.write(filename + "\n")
                #f.write(hasher.hexdigest() + "\n")
                n+=1
                a= "The given File is not malware"
                label3.config(text=a)
                    
            else:
                a= "The given File is a malware"
                label3.config(text=a)
                o+=1

         
        print("done")
        




    root = Tk()
    frame = Frame(root)
    root.title("Malware Detection")
    root.geometry("600x400")
    root.configure(background="#58F")
    frame.configure(background="#1E90FF")
    frame.pack()



    label=Label(frame, text="Malware Analysis Using Hash", font=("Verdana",10),bg="RED", fg="#FFFFFF")
    label.pack(pady=30)
    selectFileButton = Button(frame, text="Select file",font=("Verdana",10), command=selectFile)
    selectFileButton.pack(pady=20)

    label3 = Label(frame,text="Result",font=("Verdana",10),bg="GREEN", fg="#FFFFFF")
    label3.pack(pady=30)
    

    root.mainloop()



main()
