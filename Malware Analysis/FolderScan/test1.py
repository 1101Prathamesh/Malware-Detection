import hashlib
import os
from tkinter import *

n=0
o=0
py=0
hasher = hashlib.md5()


test="test1.py"
md="malwaremd5.txt"
inputdir = "C:\\Users\\Prathamesh Vanjape\\Desktop\\Malware Analysis\\malSamples"


    

##print(os.path.join(sys.path[0],"hello"))
##print(os.path.join(inputdir,"heelo.py"))
##alldict={}

##d = os.getcwd()
##print(d)
##d1 = os.path.join(d,"malSamples")
##print(d1)
for files in os.listdir(inputdir):
##    filename = os.path.join(d1, files)
    filename = files
    if(filename != test and filename != md ):
        print(filename)
        with open(filename, 'rb') as open_file:
            content = open_file.read()
            hasher.update(content)

        with open("malwaremd5.txt" , "r+") as f:
            if hasher.hexdigest() not in f.read().split("\n"):
                f.write(filename + "\n")
                f.write(hasher.hexdigest() + "\n")
    ##            alldict[filename] = "The given File is added in malware"
                print("The given File is added in malware")
                n+=1
                    
            else:
                print("The given File is a malware")
    ##            alldict[filename] = "The given File is a malware"
                o+=1


##alllist = list(map(list, alldict.items()))
##for i in alllist:
##    print(i)











    
##root = Tk()
##scrollbar = Scrollbar(root)
##scrollbar.pack( side = RIGHT, fill = Y )
##
##mylist = Listbox(root, yscrollcommand = scrollbar.set )
##
##
##mylist.pack( side = LEFT, fill = BOTH )
##scrollbar.config( command = mylist.yview )
##
##mainloop()





##def show():
##
##    tempList= [['Jim', '0.33'], ['Dave', '0.67'], ['James', '0.67'], ['Eden', '0.5']]
##
##    alllist.sort(key=lambda e: e[1], reverse=True)
##    listBox.insert(END, " Name      \t\t\t\t\t\t\t |Score\n")
##    listBox.insert(END,"-----------------------------------")
##    listBox.insert(END,"\n")
##
##    for i in range(len(tempList)):
##        listBox.insert(END,alllist[i][0])
##        listBox.insert(END,"\t \t|")
##        listBox.insert(END,alllist[i][1])
##        listBox.insert(END,"\n")
##
##scores = Tk() 
##label = Label(scores, text="High Scores", font = ("Arial",30)).grid(row = 0, columnspan = 30)
##listBox= Text(scores,width = 440)
##listBox.grid(row = 1,column= 0, columnspan = 2)
##showScores = Button(scores, text = "Show scores",width = 15, command = show).grid(row = 4, column = 0)
##closeButton = Button(scores, text = "Close",width = 15, command = exit).grid(row = 4, column = 1)
##
##scores.mainloop()


























